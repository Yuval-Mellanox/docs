{{- .Scratch.Set "content" (slice) -}}

{{- /* Match our version, our product and the given page title */ -}}
{{- /* The use of "trim" handles links like {{<link title="blah/#abc" >}} */ -}}
{{- range where (where .Site.Pages ".Params.version" .Page.Params.version) ".Params.product" .Page.Params.product -}}
    {{if not .Params.pdfhidden}}
        {{ .Scratch.Set "content" (.Scratch.Get "content" | append (dict "title" .Page.Params.title "url"  .Permalink "content"  (.Content | plainify)))}}
    {{end}}
{{end}}

{{.Scratch.Get "content"}}


{{ (dict "version" .Page.Params.version "product" .Page.Params.Product "chapters" (.Scratch.Get "content")) | jsonify }}


